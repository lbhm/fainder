2024-02-14 10:42:31 | DEBUG   | {'input': PosixPath('data/open_data_usa/histograms.zst'), 'output': 'data/open_data_usa/clusterings/microbenchmarks/k450-b50000.zst', 'feature_output': None, 'algorithm': 'kmeans', 'n_cluster_range': [450, 450], 'bin_budget': 50000, 'transform': 'quantile', 'quantile_range': (0.25, 0.75), 'use_umap': False, 'alpha': 1.0, 'workers': 112, 'seed': 42, 'log_level': 'INFO', 'log_file': PosixPath('logs/microbenchmarks/indexing/open_data_usa-clustering-k450.log')}
2024-02-14 10:42:31 | DEBUG   | Loading histograms from data/open_data_usa/histograms.zst
2024-02-14 10:42:32 | DEBUG   | Computing features
2024-02-14 10:42:33 | DEBUG   | Computing feature clustering
2024-02-14 10:42:35 | DEBUG   | Score for 450 clusters: 122118.22975726065
2024-02-14 10:42:35 | DEBUG   | Assigning histograms to clusters
2024-02-14 10:42:35 | DEBUG   | Computing cluster bins
2024-02-14 10:42:36 | DEBUG   | Number of clusters: 450
2024-02-14 10:42:36 | DEBUG   | Histograms per cluster: [394, 134, 85, 376, 480, 133, 88, 136, 216, 292, 229, 355, 520, 215, 74, 242, 397, 78, 107, 483, 256, 132, 208, 331, 232, 264, 276, 35, 74, 104, 63, 169, 133, 642, 42, 51, 300, 144, 85, 246, 144, 56, 109, 222, 70, 92, 142, 132, 83, 126, 28, 78, 121, 41, 273, 145, 24, 207, 1504, 129, 280, 40, 101, 64, 159, 447, 171, 354, 342, 332, 409, 110, 447, 24, 129, 52, 18, 56, 86, 70, 272, 278, 129, 348, 148, 181, 127, 93, 56, 115, 163, 160, 152, 113, 54, 91, 197, 192, 68, 85, 28, 101, 115, 278, 129, 88, 75, 107, 214, 24, 180, 112, 285, 78, 456, 195, 199, 379, 76, 171, 108, 91, 67, 36, 135, 41, 68, 36, 157, 53, 171, 336, 79, 365, 213, 285, 62, 105, 195, 52, 198, 192, 309, 156, 85, 94, 55, 168, 22, 421, 26, 105, 64, 110, 435, 85, 80, 208, 170, 92, 222, 435, 37, 57, 26, 213, 484, 45, 149, 140, 117, 435, 112, 261, 177, 120, 204, 23, 225, 44, 325, 42, 121, 457, 141, 51, 57, 45, 277, 138, 239, 121, 52, 196, 104, 98, 142, 91, 246, 138, 337, 39, 49, 196, 78, 75, 120, 57, 281, 291, 47, 212, 31, 116, 110, 51, 124, 179, 22, 65, 188, 43, 80, 149, 38, 64, 49, 28, 388, 372, 83, 136, 53, 81, 262, 88, 72, 27, 117, 24, 135, 299, 137, 122, 180, 115, 134, 125, 42, 196, 285, 76, 157, 104, 245, 79, 239, 116, 20, 149, 208, 263, 42, 423, 77, 436, 57, 239, 81, 317, 127, 165, 571, 162, 69, 123, 73, 72, 302, 74, 92, 107, 101, 105, 143, 169, 30, 22, 136, 788, 20, 234, 57, 55, 188, 31, 333, 25, 323, 98, 164, 91, 108, 64, 97, 47, 81, 23, 302, 179, 44, 377, 51, 238, 113, 51, 107, 120, 33, 93, 57, 349, 184, 257, 163, 224, 95, 203, 97, 67, 80, 209, 50, 65, 77, 266, 34, 20, 470, 47, 54, 69, 113, 113, 168, 96, 77, 35, 29, 79, 349, 92, 254, 114, 52, 126, 281, 97, 115, 511, 433, 307, 75, 39, 94, 44, 40, 56, 111, 36, 104, 83, 90, 94, 148, 27, 33, 267, 60, 158, 121, 108, 27, 99, 267, 73, 347, 38, 110, 140, 34, 20, 31, 239, 89, 112, 70, 49, 121, 225, 213, 47, 31, 20, 51, 84, 147, 76, 214, 85, 76, 45, 41, 78, 83, 218, 80, 251, 164, 308, 338, 49, 48, 77, 212, 72, 220, 63, 79, 94, 321, 34, 94, 53, 42, 396, 54, 78, 106, 100, 283, 38, 100, 72, 50, 30, 43, 64, 40, 309]
2024-02-14 10:42:36 | DEBUG   | Bins per cluster: [287, 98, 62, 274, 349, 97, 64, 99, 157, 213, 167, 258, 378, 157, 54, 176, 289, 57, 78, 351, 186, 96, 151, 241, 169, 192, 201, 26, 54, 76, 46, 123, 97, 467, 31, 37, 218, 105, 62, 179, 105, 41, 79, 162, 51, 67, 103, 96, 61, 92, 21, 57, 88, 30, 199, 106, 18, 151, 1094, 94, 204, 29, 74, 47, 116, 325, 125, 258, 249, 242, 298, 80, 325, 18, 94, 38, 13, 41, 63, 51, 198, 202, 94, 253, 108, 132, 93, 68, 41, 84, 119, 117, 111, 82, 39, 66, 143, 140, 50, 62, 21, 74, 84, 202, 94, 64, 55, 78, 156, 18, 131, 82, 207, 57, 332, 142, 145, 276, 55, 125, 79, 66, 49, 26, 98, 30, 50, 26, 114, 39, 125, 245, 58, 266, 155, 207, 45, 77, 142, 38, 144, 140, 225, 114, 62, 69, 40, 122, 16, 306, 19, 77, 47, 80, 317, 62, 58, 151, 124, 67, 162, 317, 27, 42, 19, 155, 352, 33, 109, 102, 85, 317, 82, 190, 129, 87, 149, 17, 164, 32, 237, 31, 88, 333, 103, 37, 42, 33, 202, 101, 174, 88, 38, 143, 76, 71, 103, 66, 179, 101, 245, 29, 36, 143, 57, 55, 87, 42, 205, 212, 34, 154, 23, 85, 80, 37, 90, 130, 16, 47, 137, 31, 58, 109, 28, 47, 36, 21, 282, 271, 61, 99, 39, 59, 191, 64, 53, 20, 85, 18, 98, 218, 100, 89, 131, 84, 98, 91, 31, 143, 207, 55, 114, 76, 178, 58, 174, 85, 15, 109, 151, 191, 31, 308, 56, 317, 42, 174, 59, 231, 93, 120, 415, 118, 50, 90, 53, 53, 220, 54, 67, 78, 74, 77, 104, 123, 22, 16, 99, 573, 15, 170, 42, 40, 137, 23, 242, 18, 235, 71, 119, 66, 79, 47, 71, 34, 59, 17, 220, 130, 32, 274, 37, 173, 82, 37, 78, 87, 24, 68, 42, 254, 134, 187, 119, 163, 69, 148, 71, 49, 58, 152, 37, 47, 56, 194, 25, 15, 342, 34, 39, 50, 82, 82, 122, 70, 56, 26, 21, 58, 254, 67, 185, 83, 38, 92, 205, 71, 84, 372, 315, 223, 55, 29, 69, 32, 29, 41, 81, 26, 76, 61, 66, 69, 108, 20, 24, 194, 44, 115, 88, 79, 20, 72, 194, 53, 253, 28, 80, 102, 25, 15, 23, 174, 65, 82, 51, 36, 88, 164, 155, 34, 23, 15, 37, 61, 107, 55, 156, 62, 55, 33, 30, 57, 61, 159, 58, 183, 119, 224, 246, 36, 35, 56, 154, 53, 160, 46, 58, 69, 234, 25, 69, 39, 31, 288, 39, 57, 77, 73, 206, 28, 73, 53, 37, 22, 31, 47, 29, 225]
2024-02-14 10:42:36 | DEBUG   | Cluster ranges: (0, 5.2916e+06), (1.09, 40.8), (6, 1.125e+05), (0, 744), (0, 26), (42, 6112), (9.8636e+05, 7.1089e+07), (10.1, 94.7), (1, 1459), (0, 0.522), (0.0001, 2.3), (0, 9998), (2003, 6003), (0, 80.37), (41, 1244.3), (255, 47238), (37.305, 47.088), (1, 91), (-1e+06, 1.6e+05), (1, 21), (0, 111), (1, 23101), (-74.244, 0.195), (0, 99557), (0, 5), (-6.6667e+08, 5.2606e+06), (0, 2018), (-8.8791e+07, 11), (1.2, 134.7), (1, 47), (-159.1, 81.5), (5746, 23266), (5.1, 10.69), (3.2205e+05, 9e+15), (-1002, 3089), (42001, 1.0901e+06), (0, 42), (10788, 1.0392e+05), (10, 96.4), (1, 7), (1, 5.075e+05), (7, 1.1111e+10), (5.37, 2117), (1, 312), (1860, 2123), (57.1, 110.8), (24244, 1.3856e+06), (1.4, 1300), (32, 3.476e+06), (1.09, 7378.5), (-6.6667e+08, 574), (10, 72), (5.33, 46.79), (0, 11.09), (1, 3287), (12, 511.32), (2.0011e+05, 2.1468e+09), (1930, 3.8789e+06), (0, 1), (0, 99), (0, 70.3), (-923, 1246), (1, 11), (-2250, 3.02), (35, 32044), (0, 37787), (2049, 2.6464e+05), (0, 4.5148e+05), (0, 3892), (0, 303), (0.0001, 0.599), (-9999, 16318), (0, 1.582), (10000, 1.0012e+05), (3.8, 86.4), (-64.7, 35), (0, 841), (164, 951), (5, 10966), (1, 30), (-1.9999e+10, 8.7422e+15), (1, 592), (0, 5), (0, 8.9526e+15), (5000, 1.0466e+14), (1.1, 20.04), (7.5, 99.2), (-1e+06, 1122), (0, 50), (6, 26660), (41107, 2.0751e+05), (0, 19.8), (54, 67292), (2018, 24671), (1, 1.1111e+15), (1.06, 365), (2.6, 99), (1, 9166), (22.222, 74.7), (1108.5, 4218), (0.2, 40), (56.74, 4.8593e+07), (61.8, 213), (0, 998), (1, 82), (1.1389e+06, 2.021e+13), (1194, 6151.8), (6, 3.739e+05), (1, 204), (3, 37), (443.86, 7042), (6, 900), (0, 84.79), (42, 497), (0, 224), (1, 24), (1.01, 6), (0, 5502.5), (57, 5421), (45, 671), (270, 1.3548e+05), (15.2, 118.5), (65, 2071), (-100, 139), (2476, 49225), (2.55, 25), (-68.8, 71.273), (0.001, 273.8), (6.9, 5128), (0, 9.19), (30109, 4.1913e+05), (1, 5272), (1.1, 20), (1.0068e+05, 7.2001e+07), (2, 99), (0, 1.8889e+05), (0.014, 42.1), (1.5964, 52577), (0, 11848), (1.1, 70.2), (1, 1927), (0, 153.6), (0, 63.6), (44, 13212), (1, 73692), (5.1, 157), (0, 28), (0, 86.2), (1, 90), (1, 3), (0.0191, 50.9), (1, 1.4583e+07), (3701, 19403), (1, 100), (0, 5.541e+08), (5.1, 60), (0, 34), (0, 2.5804e+05), (0, 5), (26.2, 178), (0, 10), (0.0004, 0.998), (-7.99, 12), (1.7, 8), (3, 10), (12, 1922), (0, 8.9985e+05), (57, 1948), (-34265, 48507), (-124.67, 0.908), (0.0017, 18.8), (0, 35.7), (1.1, 62.2), (-1.6555e+08, 3.4637e+08), (0, 95), (1.12, 3884.5), (98, 38878), (-3.292e+08, 5939), (1, 59), (0, 11470), (0, 40.861), (1e+05, 2.0101e+05), (7, 13291), (0, 373), (1.12, 26058), (1.1, 4.2e+09), (30001, 2.0211e+05), (1, 18), (0, 2015), (0, 12), (2.2, 98.4), (2.0232e+09, 3.6061e+14), (5, 27.1), (3.1608e+05, 3.0159e+07), (1.36, 5.2156e+05), (1, 40), (2116, 48120), (6.6228e+07, 2.02e+13), (-8.7398e+05, 1e+06), (28.7, 72.8), (0, 1.3476e+05), (0.02, 126.7), (0.2, 153.4), (147, 7.3012e+05), (0.0028, 29.4), (1.06, 20), (10, 320), (16.8, 75.4), (0, 701), (0, 93.76), (-122.51, 6.0596), (0, 10), (0.001, 6088.4), (14, 97630), (7.6, 64), (38.3, 842), (1.12, 40), (20000, 5e+06), (7689, 28860), (1, 1100), (0, 100), (357, 4.9542e+14), (1.76, 563), (41, 2.73e+05), (6.2, 36), (0, 19), (-86.949, 7.15), (2, 2009), (0, 0.999), (0, 62161), (1.1, 50.7), (1928, 2.6372e+08), (-1057, 720), (4.1, 90), (1, 999), (1, 92), (37.968, 11416), (0.01, 18885), (1005, 3818), (1, 5.8), (14.9, 96), (0, 94.7), (1.05, 93), (500, 13950), (60013, 6.8045e+05), (70, 4108.7), (70403, 1.0443e+06), (15, 3.2538e+05), (1000, 2052), (0, 1284), (0, 76.9), (9, 42), (1, 81), (2051, 77702), (1, 461), (5.1, 204.6), (0, 1438), (15, 982), (0.01, 5.2156e+05), (10003, 1.3738e+05), (0, 107), (0, 5565), (10, 349), (0, 3), (-138.28, 3), (0, 24608), (376, 2020), (423, 60958), (11.16, 185.11), (1.0001e+05, 5.5383e+08), (1, 42), (4111, 27164), (0, 502), (3.39, 99.4), (7.5, 49), (7.7, 82.9), (1.24, 836), (30.2, 260), (0, 30.03), (2.0075e+08, 2.0211e+13), (5.1, 108), (4, 71), (0, 2022), (10, 41405), (1, 46), (4, 98.7), (0.0476, 92.7), (202, 928), (-122.55, -74.062), (1, 5), (5532, 11249), (1, 13057), (-421.8, 41.3), (-280.19, 341), (1, 15.3), (0, 54504), (0, 1630), (33, 77), (0.186, 1), (5.59, 65169), (1.1, 90.4), (1, 134), (1, 107), (1.1, 10), (18, 11434), (6, 2004), (1.3309, 12486), (0.0001, 1.2311e+09), (0, 8048), (36, 52220), (20.83, 80.4), (0, 18), (37, 3.0731e+14), (37.605, 41.965), (7, 3631), (-5000, 9579), (10.09, 94.8), (983, 2027), (2, 93.7), (6.2, 97.4), (0.02, 650.32), (0, 3.1312e+07), (1, 63), (0, 74), (2.08, 14.7), (2018, 8.3353e+05), (0, 31.2), (0, 2617.6), (16, 7738), (42000, 4.0017e+05), (7.08, 26.7), (181, 90971), (13.59, 70), (0, 230), (-1166, 2014), (0, 3170), (6, 705), (-9998, 999), (0, 8), (0, 5450), (0, 77), (6, 3.0346e+06), (250, 2.0224e+05), (1, 82), (76.63, 22557), (6260, 41223), (3, 134.4), (0.8, 7.7), (2.0154e+05, 2.1125e+08), (1518, 22105), (1, 10), (5.81, 364), (2040, 39733), (6.59, 99), (0, 725), (44, 1.0335e+05), (1.8386e+05, 9.95e+09), (1, 100), (100, 3.6328e+06), (0, 260), (0, 1.9298e+06), (0, 104), (23, 94.83), (42.225, 380), (5.3, 36.9), (4, 84.9), (-1157.1, 90), (1, 13), (60, 974.63), (0, 49), (23175, 1.41e+05), (1, 29), (1, 37), (5, 81.79), (2078, 1.2506e+05), (53001, 7.0424e+06), (0, 90), (0, 2017), (8, 44.39), (1, 2017), (43.43, 9902), (0.9, 6), (9, 91), (1.0479, 2021), (0, 53), (33.5, 94.64), (0, 992), (2, 18), (22, 4210), (2.6968e+05, 2.2632e+06), (-1e+06, 18381), (-6.6667e+08, 71), (0.7, 39), (0.002, 6), (76, 33279), (6, 1349), (19, 2233), (0.0511, 120), (9, 7991.1), (13134, 7.3804e+07), (0, 94.78), (1.1, 33), (1, 87), (0.01, 97747), (1125, 7000), (0, 18.75), (838.63, 10967), (3.26, 857), (0, 3724), (1.2, 131.6), (0, 11), (0.002, 67), (24557, 1.0134e+05), (15.19, 83), (12.9, 124), (1, 64), (45, 543), (1.028e+05, 2.995e+07), (1, 24), (0, 501), (0, 14781), (2, 40.39), (17.6, 55.29), (11, 40.707), (0, 52), (201, 1168), (0, 122), (10.2, 37.8), (1, 39000), (40, 155), (-123.89, 0.9), (308, 1006), (4, 48.3), (0.0042, 92.953), (1, 18), (568.86, 2020), (101, 966), (3, 4785), (1, 1.182e+05), (13, 23656), (1, 825), (37, 1905), (6, 644), (1.1, 239), (0.001, 2000), (1, 2021), (-3221, 5402), (1.3, 1.058e+05), (41, 94.83), (0, 181)
2024-02-14 10:42:36 | DEBUG   | Uniform bin widths: 18438, 0.4052, 1814.5, 2.7153, 0.0745, 62.577, 1.0954e+06, 0.8545, 9.2866, 0.0025, 0.0138, 38.752, 10.582, 0.5119, 22.283, 266.95, 0.0339, 1.5789, 14872, 0.057, 0.5968, 240.62, 0.493, 413.1, 0.0296, 3.4996e+06, 10.04, 3.415e+06, 2.4722, 0.6053, 5.2304, 142.44, 0.0576, 1.9272e+13, 131.97, 28326, 0.1927, 886.95, 1.3935, 0.0335, 4833.3, 2.71e+08, 26.729, 1.9198, 5.1569, 0.8015, 13217, 13.527, 56983, 80.189, 3.1746e+07, 1.0877, 0.4711, 0.3697, 16.513, 4.7106, 1.1925e+08, 25675, 0.0009, 1.0532, 0.3446, 74.793, 0.1351, 47.937, 275.94, 116.27, 2100.7, 1749.9, 15.63, 1.2521, 0.002, 328.96, 0.0049, 5006.6, 0.8787, 2.6237, 64.692, 19.195, 173.98, 0.5686, 4.4153e+13, 2.9257, 0.0532, 3.5386e+13, 9.6908e+11, 0.1435, 0.986, 14722, 1.2195, 317.31, 1398.4, 0.1692, 605.75, 276.26, 2.849e+13, 5.5142, 0.6741, 65.464, 1.0496, 50.153, 1.8952, 6.5666e+05, 1.8, 4.9406, 0.8617, 3.1579e+11, 90.142, 4793.5, 1.3013, 1.8889, 50.368, 10.902, 0.4096, 7.9825, 0.6747, 0.162, 0.0344, 19.937, 97.527, 5.008, 1711.5, 1.5652, 40.939, 9.1923, 477.03, 0.7483, 2.8015, 10.531, 44.922, 0.2356, 3112.2, 21.514, 0.3259, 2.703e+05, 0.6258, 912.5, 0.9352, 682.8, 83.437, 1.8184, 13.375, 1.0971, 0.2827, 115.51, 1188.6, 2.2014, 0.7, 0.7066, 5.5625, 0.0065, 2.6779, 1.8938e+05, 334.09, 1.2375, 1.748e+06, 0.8855, 0.5862, 1708.9, 0.0403, 2.2657, 0.0617, 0.0031, 0.7404, 0.15, 0.3684, 12.323, 2556.4, 57.303, 759.38, 1.2312, 0.2212, 0.1126, 0.7451, 2.6943e+06, 0.7364, 44.637, 260.27, 1.9365e+07, 0.3537, 358.44, 0.1724, 3258.2, 150.95, 1.1201, 252.98, 1.1351e+08, 4097.8, 0.5152, 9.9752, 0.1188, 0.5529, 4.0978e+12, 0.5816, 2.0869e+05, 6862.6, 0.5493, 446.64, 3.0606e+11, 10469, 0.4366, 550.02, 4.3683, 4.2556, 5104.7, 0.5157, 0.3444, 3.5632, 1.3952, 3.4195, 0.4423, 3.7815, 0.0649, 264.71, 1148.4, 0.705, 21.722, 0.432, 38308, 1323.2, 23.383, 0.7299, 1.5981e+13, 9.6766, 2504.3, 1.0643, 0.4043, 2.6139, 95.571, 0.0035, 229.38, 0.8131, 2.6638e+06, 45.564, 1.4559, 5.2251, 1.4219, 214.68, 944.27, 33.094, 0.2667, 0.8276, 0.4344, 0.9195, 151.12, 4736.1, 48.079, 9937.7, 3575.5, 33.936, 8.979, 0.3715, 0.6, 0.7018, 995.41, 2.5843, 3.4397, 8.2644, 11.377, 34771, 1168.6, 0.7086, 29.136, 10.936, 0.0097, 2.5229, 77.627, 39.143, 347.9, 2.9483, 2.3971e+06, 0.4409, 192.11, 1.2096, 0.8136, 0.83, 0.8356, 15.75, 4.3358, 0.1365, 3.7427e+11, 1.5358, 0.859, 27.324, 537.6, 0.4327, 0.7699, 4.2115, 45.375, 0.4898, 0.007, 381.13, 76.8, 11.026, 15.53, 0.1044, 2369.8, 6.7355, 2.4444, 0.0035, 917.8, 0.7504, 2.0152, 1.3418, 0.1894, 160.79, 58.765, 211.6, 7.2417e+07, 36.582, 401.42, 1.8616, 0.0657, 8.3057e+12, 0.0252, 44.196, 394.03, 1.086, 12, 3.8208, 1.3412, 15.483, 1.2327e+05, 0.4627, 0.3957, 0.1061, 5101.3, 0.4522, 17.686, 108.76, 7309.6, 0.3383, 597.3, 1.5246, 4.8936, 56.786, 16.34, 27.96, 733.13, 0.0234, 160.29, 1.9744, 60692, 2463.3, 0.9878, 184.27, 499.47, 2.3464, 0.2654, 1.005e+07, 354.95, 0.0354, 5.3461, 203.75, 1.1134, 19.079, 1122.9, 4.8536e+07, 1.3944, 43246, 0.6989, 6126.5, 0.4664, 1.306, 11.647, 0.458, 2.5281, 43.003, 0.2927, 11.292, 1.8846, 1550.3, 0.459, 0.5455, 1.1129, 1138.7, 3.4947e+05, 3.75, 10.397, 0.827, 17.53, 112.03, 0.0646, 4.1, 28.055, 0.2732, 1.1536, 3.9209, 0.5714, 52.35, 19545, 40735, 4.4444e+07, 1.6652, 0.0345, 510.82, 16.378, 43.412, 3.3319, 90.705, 4.4994e+05, 0.6115, 0.9382, 3.7391, 6516.5, 158.78, 0.3074, 94.658, 15.522, 23.872, 2.1032, 0.2, 2.0302, 2559.4, 1.1896, 1.8213, 0.3962, 8.5862, 1.631e+05, 0.1933, 2.2366, 60.085, 1.0664, 1.0769, 0.5305, 0.3377, 18.245, 0.7625, 0.6, 672.4, 1.6667, 0.5333, 27.92, 0.642, 2.3833, 0.5484, 5.0387, 22.18, 83.895, 1535.1, 323.88, 4, 66.714, 8.7397, 4.4887, 54.054, 91.818, 278.16, 2251.1, 1.8562, 0.8044
2024-02-14 10:42:36 | DEBUG   | Predicted (rebinning) index size: 81.08 MB
2024-02-14 10:42:36 | INFO    | Clustered 68313 histograms into 450 clusters in 4.08s
2024-02-14 10:42:36 | TRACE   | total_time, 4.082074945792556
2024-02-14 10:42:36 | DEBUG   | Saving output
2024-02-14 10:42:37 | DEBUG   | Saved clustering to data/open_data_usa/clusterings/microbenchmarks/k450-b50000.zst
